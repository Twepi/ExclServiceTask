### Задание

 Написать сервис который обрабатывает excl файл,
 посылает запросы на сервис задания на эндпоинт ``/api/excl`` по полученным данным и
 формирует файл результата из ответов.

- Считать таблицу и по каждой строке создать json
- Отправить json на сервер на эндпоинт ``/api/excl``
- Полученные ответы записать в файл.

### Подготовка

 Таблица с данными находится в корне репозитория.
 Чтобы запустить сервис задания необходимо скачать docker image с
 https://hub.docker.com/repository/docker/twep/api-excl-server/general
 и запустить контейнер на нужном порту.

* Eсли у вас не установлен docker, его необходимо установить с
  https://www.docker.com/products/docker-desktop/
* Далее необходимо скачать image сервиса: </br>
  ``docker pull twep/api-excl-server:default``
* Следующая команда запускает сервис задания на порту 8080
  в активной консоли/терминале.</br>
  ``docker run -it -p 8080:8080 twep/api-excl-server:default``</br>
  Сервис будет писать свои логи в терминале из которого он был создан
  и будет работать по адресу http://localhost:8080.
  Если необходимо поменять порт сервиса, нужно изменить аргумента флага -p,
  например ``-p 9080:8080`` запускает сервис на порту 9080.</br>

### Формат запроса

Для формирования запроса на сервис задания необходимы данные из следующих столбцов таблицы:

| Code | Sender | Email | Order Number | Invoice |
| ---- | ------ | ----- | ------------ | ------- |

По каждой строке таблицы необходимо сформировать json следующего формата:

```yaml
{
  "Code":    "V034929",
  "Sender":  "George",
  "Email":   "laurine.halvorson41@gmail.com",
  "Order":   "PO00932310",
  "Invoice": "PL020025371"
}
```

**Code:**

* не должен быть пустой строкой
* должен иметь длину 7 символов
* должен начинаться с префикса "VO"
* последний элемент строки должен быть числом
* это число должно быть нечетным

**Sender:**

* не должен быть пустой строкой
* строка не должна содержать численых символов

**Email:**

* не должен быть пустой строкой
* строка должна соотвествовать формату mail адреса
* почтовая почта ячейки должна быть gmail

**Order:**

* не должен быть пустой строкой
* должен должен иметь длину 10 символов
* начинаться с префикса "PO"

**Invoice:**

* не должен быть пустой строкой
* должен иметь длину 11 символов
* должен начинаться с префикса "PL"

### Ответ сервиса

После того как вы отправили сформированный json на http://localhost:8080/api/excl
вы получаете ответ от сервиса в зависимости от корректности отправленных данных:

* **Success:** статус результата
* **Description:** описание ошибки если она имеется
* **Received:** переданный объект
* **Result:** сгенерированный хеш записи при верном результате

```yaml
{
  Success:     true,
  Description: "Hash was successfully generated!",
  Received:    {
    "code":    "V045935",
    "email":   "antwon36@gmail.com",
    "invoice": "PL020685210",
    "order":   "PO00934281",
    "sender":  "КТК ООО",
  },
  Result: "bcf46f634b8ddb641f894c4bb30b400ba2b67c14c1c74c4f22f3e12ff4661cde",
}
```

```yaml
{
  Success:     false,
  Description: "Your object didn't pass validation: sender consist only of numbers, wrong email provided, wrong order length",
  Received:    {
    "code":    "V045541",
    "email":   "florian69@yahoo.com",
    "invoice": "PL019355473",
    "order":   "TO007580767",
    "sender":  "164",
  },
  Result: "",
}
```

Генерация ответа сервиса занимает от 3 до 7 секунд.

### Файл хешей

После получения ответа с сервера задания необходимо создать файл
в формате

```
"номер строки" "хеш записи" "секунд прошло с начала до ответа сервера"
```

Пример правильного заполнения файла:

```
27	222a1f16b8c12fab2939d0166ac2e1683e0736d5669530e5e3969bd4d2de2644	-6.063387
48	626e67f373b19aeacdcf3d2a25eb0ab06cf28ee0161f1cec0ab3c5ab095da8f7	-3.063642
51	a1661da5bc544b28f212a2c09fc60ab9d979ee224a6c1dece2df306ce3e916e7	-5.062473
74	616b31e4eae2316b047e24e1d6463e51705a02b42b3370e02064990f5e64c903	-6.063466
85	bcf46f634b8ddb641f894c4bb30b400ba2b67c14c1c74c4f22f3e12ff4661cde	-6.063477
86	58f7f872f30d2c6e06bd2a25018b416287985a25c8ecfbc000598ff5129814cd	-6.063345
104	9468dea7191f70c094dc452324dc3f90a20d9e54cf39f3fd4009e56197f6ea90	-5.063655
118	7cd635fd5b7b87a712169cd21d24670124343ecc14238d92bd24fc96358a8cfb	-4.063629
129	233d85de6bb7c9624de8f79164032b67a4d1b66655b5a5e5c32efabe2bc36f4d	-5.061776
132	b4ee4fe42725bca0ca2d5320b090c5382baaba6ee7a99167b1f67487bb969680	-4.005587
```

### Очистка памяти от docker image и контейнеров

Чтобы не захламлять пространство компьютера можно удалить имедж и контейнер после завершения задания.</br>

- Удаления всех контейнеров связанных с имеджами задания:</br>
  ``docker rm $(docker ps -a -q  --filter ancestor='twep/api-excl-server:default')``</br>
  ``docker rm $(docker ps -a -q  --filter ancestor='twep/api-excl-server:errored')``
- Удаление имеджей:</br>
  ``docker rmi twep/api-excl-server:default``</br>
  ``docker rmi twep/api-excl-server:errored``
